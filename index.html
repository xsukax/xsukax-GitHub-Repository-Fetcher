<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>xsukax GitHub Repository Fetcher</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { --primary-color: #2d333b; --secondary-color: #22272e; --accent-color: #238636; --text-color: #cdd9e5; --border-color: #444c56; --card-bg: #1c2128; --input-bg: #22272e; --danger-color: #f85149; --warning-color: #d29922; }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif; }
        body { background-color: var(--primary-color); color: var(--text-color); line-height: 1.6; padding: 20px; min-height: 100vh; }
        .container { max-width: 1000px; margin: 0 auto; padding: 0 20px; }
        header { text-align: center; margin-bottom: 40px; padding-top: 20px; }
        h1 { font-size: 2.5rem; margin-bottom: 10px; background: linear-gradient(135deg, #58a6ff, #238636); -webkit-background-clip: text; background-clip: text; color: transparent; }
        .subtitle { color: #8b949e; font-size: 1.1rem; max-width: 600px; margin: 0 auto; }
        .rate-limit-card { background-color: var(--secondary-color); border-radius: 12px; padding: 20px; margin-bottom: 20px; border: 1px solid var(--border-color); }
        .rate-limit-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .rate-limit-header h3 { font-size: 1.2rem; display: flex; align-items: center; gap: 10px; }
        .rate-limit-badge { background-color: #373e47; padding: 5px 12px; border-radius: 20px; font-size: 0.85rem; font-weight: normal; }
        .rate-limit-badge.good { background-color: rgba(46, 160, 67, 0.2); color: #2ea043; border: 1px solid rgba(46, 160, 67, 0.4); }
        .rate-limit-badge.warning { background-color: rgba(210, 153, 34, 0.2); color: #d29922; border: 1px solid rgba(210, 153, 34, 0.4); }
        .rate-limit-badge.danger { background-color: rgba(248, 81, 73, 0.2); color: #f85149; border: 1px solid rgba(248, 81, 73, 0.4); }
        .rate-limit-info { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; }
        .rate-limit-stat { background-color: var(--input-bg); padding: 12px; border-radius: 8px; text-align: center; }
        .rate-limit-stat .label { font-size: 0.85rem; color: #8b949e; margin-bottom: 5px; }
        .rate-limit-stat .value { font-size: 1.5rem; font-weight: 600; color: var(--text-color); }
        .rate-limit-stat .value.danger { color: var(--danger-color); }
        .rate-limit-stat .value.warning { color: var(--warning-color); }
        .rate-limit-stat .value.good { color: #2ea043; }
        .progress-bar { width: 100%; height: 8px; background-color: var(--input-bg); border-radius: 4px; overflow: hidden; margin-top: 15px; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, #238636, #2ea043); transition: width 0.3s ease; }
        .progress-fill.warning { background: linear-gradient(90deg, #d29922, #f0883e); }
        .progress-fill.danger { background: linear-gradient(90deg, #f85149, #da3633); }
        .reset-info { margin-top: 10px; font-size: 0.85rem; color: #8b949e; text-align: center; }
        .app-container { background-color: var(--secondary-color); border-radius: 12px; padding: 30px; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3); border: 1px solid var(--border-color); }
        .input-section { margin-bottom: 30px; }
        .input-group { display: flex; gap: 10px; margin-bottom: 15px; }
        input { flex: 1; padding: 15px; background-color: var(--input-bg); border: 1px solid var(--border-color); border-radius: 8px; color: var(--text-color); font-size: 1rem; transition: all 0.3s; }
        input:focus { outline: none; border-color: #58a6ff; box-shadow: 0 0 0 3px rgba(88, 166, 255, 0.2); }
        input:disabled { opacity: 0.5; cursor: not-allowed; background-color: #1c2128; }
        button { background-color: var(--accent-color); color: white; border: none; border-radius: 8px; padding: 0 25px; font-size: 1rem; font-weight: 600; cursor: pointer; transition: all 0.3s; display: flex; align-items: center; justify-content: center; gap: 8px; }
        button:hover { background-color: #2ea043; transform: translateY(-2px); }
        button:active { transform: translateY(0); }
        button:disabled { background-color: #4a5568; cursor: not-allowed; transform: none; opacity: 0.6; }
        .secondary-btn { background-color: #373e47; color: var(--text-color); }
        .secondary-btn:hover { background-color: #444c56; }
        .examples { font-size: 0.9rem; color: #8b949e; margin-top: 10px; }
        .examples span { display: inline-block; margin-right: 15px; }
        .examples i { margin-right: 5px; }
        .status { padding: 15px; border-radius: 8px; margin: 20px 0; text-align: center; display: none; }
        .status.error { background-color: rgba(248, 81, 73, 0.15); border: 1px solid rgba(248, 81, 73, 0.4); color: #f85149; }
        .status.success { background-color: rgba(46, 160, 67, 0.15); border: 1px solid rgba(46, 160, 67, 0.4); color: #2ea043; }
        .status.info { background-color: rgba(88, 166, 255, 0.15); border: 1px solid rgba(88, 166, 255, 0.4); color: #58a6ff; }
        .status.warning { background-color: rgba(210, 153, 34, 0.15); border: 1px solid rgba(210, 153, 34, 0.4); color: #d29922; }
        .results-section { display: none; }
        .search-section { margin-bottom: 20px; }
        .search-input { width: 100%; }
        .results-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; padding-bottom: 15px; border-bottom: 1px solid var(--border-color); }
        .results-header h2 { font-size: 1.5rem; }
        .repo-count { background-color: #373e47; padding: 5px 12px; border-radius: 20px; font-size: 0.9rem; }
        .repositories-list { max-height: 400px; overflow-y: auto; border-radius: 8px; border: 1px solid var(--border-color); }
        .repository-item { padding: 15px; border-bottom: 1px solid var(--border-color); display: flex; justify-content: space-between; align-items: center; transition: background-color 0.2s; cursor: pointer; text-decoration: none; color: var(--text-color); }
        .repository-item:hover { background-color: rgba(88, 166, 255, 0.1); }
        .repository-item:last-child { border-bottom: none; }
        .repo-info { display: flex; align-items: center; gap: 15px; flex: 1; }
        .repo-icon { color: #58a6ff; font-size: 1.2rem; }
        .repo-details { flex: 1; }
        .repo-name { font-weight: 600; margin-bottom: 3px; }
        .repo-url { color: #8b949e; font-size: 0.9rem; word-break: break-all; }
        .repo-number { color: #8b949e; font-size: 0.9rem; min-width: 40px; text-align: right; }
        .empty-state { text-align: center; padding: 40px 20px; color: #8b949e; }
        .empty-state i { font-size: 3rem; margin-bottom: 15px; opacity: 0.5; }
        .actions-row { display: flex; gap: 10px; margin-top: 25px; }
        .actions-row button { flex: 1; }
        footer { text-align: center; margin-top: 40px; color: #8b949e; font-size: 0.9rem; padding-bottom: 20px; }
        footer a { color: #58a6ff; text-decoration: none; }
        footer a:hover { text-decoration: underline; }
        .loading-overlay { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background-color: rgba(0, 0, 0, 0.7); display: none; justify-content: center; align-items: center; z-index: 1000; }
        .loading-spinner { text-align: center; color: var(--text-color); }
        .loading-spinner i { font-size: 3rem; margin-bottom: 20px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        @media (max-width: 768px) { .input-group { flex-direction: column; } button { width: 100%; padding: 15px; } .repository-item { flex-direction: column; align-items: flex-start; gap: 10px; } .repo-url { max-width: 100%; } .actions-row { flex-direction: column; } .rate-limit-info { grid-template-columns: 1fr; } }
    </style>
</head>
<body>
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner">
            <i class="fas fa-spinner"></i>
            <p>Checking API Rate Limit...</p>
        </div>
    </div>

    <div class="container">
        <header>
            <h1><i class="fab fa-github"></i> xsukax GitHub Repository Fetcher</h1>
            <p class="subtitle">Enter a GitHub username or profile URL to fetch all repository URLs. Download them as a plain text file with a single click.</p>
        </header>

        <div class="rate-limit-card">
            <div class="rate-limit-header">
                <h3>
                    <i class="fas fa-tachometer-alt"></i> API Rate Limit Status
                </h3>
                <span class="rate-limit-badge" id="rateLimitBadge">Checking...</span>
            </div>
            <div class="rate-limit-info">
                <div class="rate-limit-stat">
                    <div class="label">Remaining</div>
                    <div class="value" id="remainingRequests">--</div>
                </div>
                <div class="rate-limit-stat">
                    <div class="label">Total Limit</div>
                    <div class="value" id="totalLimit">--</div>
                </div>
                <div class="rate-limit-stat">
                    <div class="label">Used</div>
                    <div class="value" id="usedRequests">--</div>
                </div>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill" style="width: 0%"></div>
            </div>
            <div class="reset-info" id="resetInfo">Rate limit resets at: --</div>
        </div>
        
        <main class="app-container">
            <div class="input-section">
                <div class="input-group">
                    <input type="text" id="githubInput" placeholder="Enter GitHub username or profile URL (e.g., 'torvalds' or 'https://github.com/torvalds')" autofocus>
                    <button id="fetchButton">
                        <i class="fas fa-search"></i> Fetch Repositories
                    </button>
                </div>
                <div class="examples">
                    <span><i class="fas fa-lightbulb"></i> Try: xsukax</span>
                    <span><i class="fas fa-lightbulb"></i> Try: https://github.com/facebook</span>
                    <span><i class="fas fa-lightbulb"></i> Try: torvalds</span>
                </div>
            </div>
            
            <div id="statusMessage" class="status"></div>
            
            <div class="results-section" id="resultsSection">
                <div class="search-section">
                    <input type="text" id="searchInput" class="search-input" placeholder="ðŸ” Search repositories...">
                </div>
                
                <div class="results-header">
                    <h2>Repositories</h2>
                    <div class="repo-count" id="repoCount">0 repositories</div>
                </div>
                
                <div class="repositories-list" id="repositoriesList">
                    <div class="empty-state">
                        <i class="fas fa-code-branch"></i>
                        <p>Repositories will appear here after fetching</p>
                    </div>
                </div>
                
                <div class="actions-row">
                    <button id="downloadButton" class="secondary-btn">
                        <i class="fas fa-download"></i> Download URLs as TXT
                    </button>
                    <button id="copyButton" class="secondary-btn">
                        <i class="fas fa-copy"></i> Copy All URLs
                    </button>
                </div>
            </div>
        </main>
        
        <footer>
            <p>This tool uses the official GitHub API. Unauthenticated requests are limited to 60 per hour.</p>
            <p>Created with <i class="fas fa-heart" style="color: #f85149;"></i> for developers | <a href="https://github.com" target="_blank">GitHub</a></p>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const githubInput = document.getElementById('githubInput');
            const fetchButton = document.getElementById('fetchButton');
            const statusMessage = document.getElementById('statusMessage');
            const resultsSection = document.getElementById('resultsSection');
            const repositoriesList = document.getElementById('repositoriesList');
            const repoCount = document.getElementById('repoCount');
            const downloadButton = document.getElementById('downloadButton');
            const copyButton = document.getElementById('copyButton');
            const searchInput = document.getElementById('searchInput');
            const loadingOverlay = document.getElementById('loadingOverlay');
            
            const remainingRequestsEl = document.getElementById('remainingRequests');
            const totalLimitEl = document.getElementById('totalLimit');
            const usedRequestsEl = document.getElementById('usedRequests');
            const rateLimitBadge = document.getElementById('rateLimitBadge');
            const progressFill = document.getElementById('progressFill');
            const resetInfo = document.getElementById('resetInfo');
            
            let allRepositories = [];
            let filteredRepositories = [];
            let rateLimitData = null;
            
            // Check rate limit on page load
            checkRateLimit();
            
            fetchButton.addEventListener('click', fetchRepositories);
            
            githubInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    fetchRepositories();
                }
            });
            
            downloadButton.addEventListener('click', downloadURLs);
            copyButton.addEventListener('click', copyURLs);
            
            searchInput.addEventListener('input', function() {
                const searchTerm = searchInput.value.toLowerCase().trim();
                
                if (searchTerm === '') {
                    filteredRepositories = allRepositories;
                } else {
                    filteredRepositories = allRepositories.filter(repo => 
                        repo.name.toLowerCase().includes(searchTerm) ||
                        repo.url.toLowerCase().includes(searchTerm)
                    );
                }
                
                displayRepositories(filteredRepositories);
            });
            
            async function checkRateLimit() {
                loadingOverlay.style.display = 'flex';
                
                try {
                    const response = await fetch('https://api.github.com/rate_limit');
                    
                    if (!response.ok) {
                        throw new Error('Failed to fetch rate limit');
                    }
                    
                    const data = await response.json();
                    rateLimitData = data.resources.core;
                    
                    updateRateLimitUI();
                    
                    // Check if remaining is 0
                    if (rateLimitData.remaining === 0) {
                        disableInput();
                        showStatus('âš ï¸ API rate limit exceeded. Please wait until the reset time.', 'error');
                    }
                    
                } catch (error) {
                    console.error('Error checking rate limit:', error);
                    showStatus('Failed to check rate limit. You can still try to fetch repositories.', 'warning');
                } finally {
                    loadingOverlay.style.display = 'none';
                }
            }
            
            function updateRateLimitUI() {
                if (!rateLimitData) return;
                
                const remaining = rateLimitData.remaining;
                const limit = rateLimitData.limit;
                const used = limit - remaining;
                const percentage = (remaining / limit) * 100;
                
                remainingRequestsEl.textContent = remaining;
                totalLimitEl.textContent = limit;
                usedRequestsEl.textContent = used;
                
                // Update progress bar
                progressFill.style.width = percentage + '%';
                
                // Update colors based on remaining percentage
                if (percentage > 50) {
                    remainingRequestsEl.className = 'value good';
                    progressFill.className = 'progress-fill';
                    rateLimitBadge.className = 'rate-limit-badge good';
                    rateLimitBadge.textContent = 'Healthy';
                } else if (percentage > 20) {
                    remainingRequestsEl.className = 'value warning';
                    progressFill.className = 'progress-fill warning';
                    rateLimitBadge.className = 'rate-limit-badge warning';
                    rateLimitBadge.textContent = 'Low';
                } else {
                    remainingRequestsEl.className = 'value danger';
                    progressFill.className = 'progress-fill danger';
                    rateLimitBadge.className = 'rate-limit-badge danger';
                    rateLimitBadge.textContent = remaining === 0 ? 'Exhausted' : 'Critical';
                }
                
                // Update reset time
                const resetDate = new Date(rateLimitData.reset * 1000);
                resetInfo.textContent = `Rate limit resets at: ${resetDate.toLocaleString()}`;
            }
            
            function disableInput() {
                githubInput.disabled = true;
                fetchButton.disabled = true;
                githubInput.placeholder = 'API rate limit exceeded - input disabled';
            }
            
            function enableInput() {
                githubInput.disabled = false;
                fetchButton.disabled = false;
                githubInput.placeholder = "Enter GitHub username or profile URL (e.g., 'torvalds' or 'https://github.com/torvalds')";
            }
            
            async function fetchRepositories() {
                // Check rate limit before fetching
                if (rateLimitData && rateLimitData.remaining === 0) {
                    showStatus('Cannot fetch repositories. API rate limit exceeded. Please wait until the reset time.', 'error');
                    return;
                }
                
                const input = githubInput.value.trim();
                
                if (!input) {
                    showStatus('Please enter a GitHub username or profile URL', 'error');
                    return;
                }
                
                let username = extractUsername(input);
                
                if (!username) {
                    showStatus('Invalid GitHub username or URL format', 'error');
                    return;
                }
                
                fetchButton.disabled = true;
                fetchButton.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Fetching...';
                showStatus(`Fetching repositories for ${username}...`, 'info');
                
                try {
                    const response = await fetch(`https://api.github.com/users/${username}/repos?per_page=100&sort=updated`);
                    
                    // Update rate limit after request
                    await checkRateLimit();
                    
                    if (!response.ok) {
                        if (response.status === 404) {
                            throw new Error('User not found');
                        } else if (response.status === 403) {
                            throw new Error('API rate limit exceeded. Try again later.');
                        } else {
                            throw new Error(`GitHub API error: ${response.status}`);
                        }
                    }
                    
                    let repos = await response.json();
                    
                    // Check if there are more pages
                    const linkHeader = response.headers.get('Link');
                    if (linkHeader) {
                        const totalPages = parseLinkHeader(linkHeader);
                        
                        // Fetch remaining pages (up to 1000 repos total = 10 pages)
                        const maxPages = Math.min(totalPages, 10);
                        const promises = [];
                        
                        for (let page = 2; page <= maxPages; page++) {
                            promises.push(
                                fetch(`https://api.github.com/users/${username}/repos?per_page=100&sort=updated&page=${page}`)
                                    .then(res => res.json())
                            );
                        }
                        
                        const additionalRepos = await Promise.all(promises);
                        repos = repos.concat(...additionalRepos);
                        
                        // Update rate limit after all requests
                        await checkRateLimit();
                    }
                    
                    if (repos.length === 0) {
                        showStatus('No repositories found for this user', 'info');
                        allRepositories = [];
                        filteredRepositories = [];
                        displayRepositories([]);
                    } else {
                        allRepositories = repos.map(repo => ({
                            name: repo.name,
                            url: repo.html_url
                        }));
                        
                        filteredRepositories = allRepositories;
                        
                        displayRepositories(filteredRepositories);
                        
                        showStatus(`Successfully fetched ${allRepositories.length} repositories`, 'success');
                        
                        resultsSection.style.display = 'block';
                        
                        resultsSection.scrollIntoView({ behavior: 'smooth' });
                        
                        searchInput.value = '';
                    }
                } catch (error) {
                    showStatus(`Error: ${error.message}`, 'error');
                    allRepositories = [];
                    filteredRepositories = [];
                    displayRepositories([]);
                    
                    // Still update rate limit on error
                    await checkRateLimit();
                } finally {
                    fetchButton.disabled = rateLimitData && rateLimitData.remaining === 0;
                    fetchButton.innerHTML = '<i class="fas fa-search"></i> Fetch Repositories';
                }
            }
            
            function parseLinkHeader(header) {
                const lastMatch = header.match(/&page=(\d+)>; rel="last"/);
                return lastMatch ? parseInt(lastMatch[1]) : 1;
            }
            
            function extractUsername(input) {
                if (!input.includes('/') && !input.includes('.')) {
                    return input;
                }
                
                try {
                    const url = new URL(input.includes('://') ? input : `https://${input}`);
                    
                    if (url.hostname.includes('github.com')) {
                        const pathParts = url.pathname.split('/').filter(part => part);
                        
                        if (pathParts.length >= 1) {
                            return pathParts[0];
                        }
                    }
                } catch (e) {
                    const githubRegex = /(?:https?:\/\/)?(?:www\.)?github\.com\/([^\/\s]+)/i;
                    const match = input.match(githubRegex);
                    
                    if (match && match[1]) {
                        return match[1];
                    }
                }
                
                return null;
            }
            
            function displayRepositories(repos) {
                repositoriesList.innerHTML = '';
                
                if (repos.length === 0) {
                    repositoriesList.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-code-branch"></i>
                            <p>${allRepositories.length === 0 ? 'No repositories found' : 'No matching repositories'}</p>
                        </div>
                    `;
                    repoCount.textContent = `0 repositories`;
                    downloadButton.disabled = true;
                    copyButton.disabled = true;
                    return;
                }
                
                repoCount.textContent = `${repos.length} ${repos.length === 1 ? 'repository' : 'repositories'}${repos.length !== allRepositories.length ? ` (${allRepositories.length} total)` : ''}`;
                
                downloadButton.disabled = false;
                copyButton.disabled = false;
                
                repos.forEach((repo, index) => {
                    const repoItem = document.createElement('a');
                    repoItem.className = 'repository-item';
                    repoItem.href = repo.url;
                    repoItem.target = '_blank';
                    repoItem.rel = 'noopener noreferrer';
                    repoItem.innerHTML = `
                        <div class="repo-info">
                            <div class="repo-icon">
                                <i class="fas fa-book"></i>
                            </div>
                            <div class="repo-details">
                                <div class="repo-name">${repo.name}</div>
                                <div class="repo-url">${repo.url}</div>
                            </div>
                        </div>
                        <div class="repo-number">#${index + 1}</div>
                    `;
                    repositoriesList.appendChild(repoItem);
                });
            }
            
            function downloadURLs() {
                if (allRepositories.length === 0) {
                    showStatus('No repositories to download', 'error');
                    return;
                }
                
                const textContent = allRepositories.map(repo => repo.url).join('\n');
                
                const blob = new Blob([textContent], { type: 'text/plain' });
                const url = URL.createObjectURL(blob);
                
                const a = document.createElement('a');
                a.href = url;
                
                const username = extractUsername(githubInput.value.trim()) || 'github_user';
                a.download = `${username}_repositories.txt`;
                
                document.body.appendChild(a);
                a.click();
                
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                showStatus(`Downloaded ${allRepositories.length} repository URLs`, 'success');
            }
            
            async function copyURLs() {
                if (allRepositories.length === 0) {
                    showStatus('No repositories to copy', 'error');
                    return;
                }
                
                const textContent = allRepositories.map(repo => repo.url).join('\n');
                
                try {
                    await navigator.clipboard.writeText(textContent);
                    showStatus(`Copied ${allRepositories.length} repository URLs to clipboard`, 'success');
                } catch (err) {
                    showStatus('Failed to copy to clipboard', 'error');
                }
            }
            
            function showStatus(message, type) {
                statusMessage.textContent = message;
                statusMessage.className = `status ${type}`;
                statusMessage.style.display = 'block';
                
                if (type === 'success') {
                    setTimeout(() => {
                        statusMessage.style.display = 'none';
                    }, 5000);
                }
            }
        });
    </script>
</body>
</html>
